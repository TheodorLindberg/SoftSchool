const html = `


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>SchoolSoft</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
  <meta http-equiv="Expires" content="0"/>
  <meta http-equiv="Pragma" content="no-cache"/>
  <meta http-equiv="Cache-Control" content="no-cache"/>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#234675">
<meta name="msapplication-TileColor" content="#234675">
<meta name="theme-color" content="#234675">
  <link href="../../style/frameset.css?rev=2.7" rel="styleSheet" type="text/css"/>
  
    <link href="../../style/StyleSheetNew.css?rev=3.10" rel="styleSheet" type="text/css"/>
    <link href="../../style/StyleSheetMenu.css?rev=2.5" rel="styleSheet" type="text/css"/>
    <link href="../../style/mainSheet.css?rev=6.1" rel="styleSheet" media="all" type="text/css"/>
    
        <link href="../../style/student_sheet.css?rev=2.6" rel="styleSheet" type="text/css"/>
        
    
  
  <script async src="/rudbeck/react/browser-warning.e8916709826cf4ff3b5388d9f0bbe537.js"></script>

</head>

<body class="print">



  <center><span class="printLarge">
    Schema för Theodor Lindberg
    v34
    </span><br /><br />
    <script language="JavaScript" src="../../script/boxover.js?rev=1.001" type="text/javascript"></script>
<table class="print" width="100%"><tr class="background schedulerow"><td align="center" class="printSmallBold schedulecell"><b>Tid</b></td><td></td><td align="center" colspan="4" class="printSmallBold schedulecell"><b>&nbsp;&nbsp;Mån</b>&nbsp;&nbsp;</td><td align="center" colspan="4" class="printSmallBold schedulecell"><b>&nbsp;&nbsp;Tis</b>&nbsp;&nbsp;</td><td align="center" colspan="4" class="printSmallBold schedulecell"><b>&nbsp;&nbsp;Ons</b>&nbsp;&nbsp;</td><td align="center" colspan="4" class="printSmallBold schedulecell"><b>&nbsp;&nbsp;Tor</b>&nbsp;&nbsp;</td><td align="center" colspan="4" class="printSmallBold schedulecell"><b>&nbsp;&nbsp;Fre</b>&nbsp;&nbsp;</td></tr><tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">8:00</td><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="30" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="4" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="4" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="4" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="4" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="23" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>KEMKEM02</b></td><td class="printTiny"  align="right" nowrap="nowrap">8:20</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >S2-023a
</td><td class="printTiny"  align="right" nowrap="nowrap">-10:15</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">KE2752170
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Gunnar Alkemar
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="23" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>MATMAT03c</b></td><td class="printTiny"  align="right" nowrap="nowrap">8:20</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >K005
</td><td class="printTiny"  align="right" nowrap="nowrap">-10:15</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">MA3C+413212+6
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Johan Diser
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="23" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>BIOBIO01</b></td><td class="printTiny"  align="right" nowrap="nowrap">8:20</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >S2-015
</td><td class="printTiny"  align="right" nowrap="nowrap">-10:15</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">BI1122170
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Helena Lexander
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1, P2
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="23" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>MATMAT03c</b></td><td class="printTiny"  align="right" nowrap="nowrap">8:20</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >K004
</td><td class="printTiny"  align="right" nowrap="nowrap">-10:15</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">MA3C+413212+6
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Johan Diser
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">8:30</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">9:00</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">9:30</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">10:00</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="3" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="17" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="3" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="3" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">10:30</td><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>MATMAT03c</b></td><td class="printTiny"  align="right" nowrap="nowrap">10:30</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >K005
</td><td class="printTiny"  align="right" nowrap="nowrap">-11:30</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">MA3C+413212+6
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Johan Diser
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>MATMAT03c</b></td><td class="printTiny"  align="right" nowrap="nowrap">10:30</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >K004
</td><td class="printTiny"  align="right" nowrap="nowrap">-11:30</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">MA3C+413212+6
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Johan Diser
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>FYSFYS01a</b></td><td class="printTiny"  align="right" nowrap="nowrap">10:30</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >D105
</td><td class="printTiny"  align="right" nowrap="nowrap">-11:30</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">FY1A132180
</td></tr><tr class="schedulerow"  ><td class="printSchedule schedulecell"  colspan="2">Markus Himmelstrand
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1, P2, P3
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>KEMKEM02</b></td><td class="printTiny"  align="right" nowrap="nowrap">10:30</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >S2-023a
</td><td class="printTiny"  align="right" nowrap="nowrap">-11:30</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">KE2752170
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Gunnar Alkemar
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">11:00</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">11:30</td><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="15" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="2" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="15" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="2" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="7" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>MENTORSTID</b></td><td class="printTiny"  align="right" nowrap="nowrap">11:40</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >S2-023a
</td><td class="printTiny"  align="right" nowrap="nowrap">-12:15</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">M NA3 20 MDA
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>ENGENG06</b></td><td class="printTiny"  align="right" nowrap="nowrap">11:40</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >M112
</td><td class="printTiny"  align="right" nowrap="nowrap">-12:40</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">EN6742150
</td></tr><tr class="schedulerow"  ><td class="printSchedule schedulecell"  colspan="2">Ulrika Eriksson Brandt
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="10" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>ENGENG06</b></td><td class="printTiny"  align="right" nowrap="nowrap">11:40</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >M112
</td><td class="printTiny"  align="right" nowrap="nowrap">-12:30</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">EN6742150
</td></tr><tr class="schedulerow"  ><td class="printSchedule schedulecell"  colspan="2">Ulrika Eriksson Brandt
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">12:00</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="10" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">12:30</td><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="17" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="52" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>ENGENG06</b></td><td class="printTiny"  align="right" nowrap="nowrap">12:45</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >M112
</td><td class="printTiny"  align="right" nowrap="nowrap">-13:45</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">EN6742150
</td></tr><tr class="schedulerow"  ><td class="printSchedule schedulecell"  colspan="2">Ulrika Eriksson Brandt
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>ENGENG06</b></td><td class="printTiny"  align="right" nowrap="nowrap">12:45</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >M112
</td><td class="printTiny"  align="right" nowrap="nowrap">-13:45</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">EN6742150
</td></tr><tr class="schedulerow"  ><td class="printSchedule schedulecell"  colspan="2">Ulrika Eriksson Brandt
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">13:00</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>BIOBIO01</b></td><td class="printTiny"  align="right" nowrap="nowrap">13:05</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >S2-015
</td><td class="printTiny"  align="right" nowrap="nowrap">-14:05</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">BI1122170
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Helena Lexander
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1, P2
</td></tr></table></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">13:30</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="2" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="16" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>KEMKEM02</b></td><td class="printTiny"  align="right" nowrap="nowrap">13:55</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >S2-023a
</td><td class="printTiny"  align="right" nowrap="nowrap">-14:55</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">KE2752170
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Gunnar Alkemar
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>FYSFYS01a</b></td><td class="printTiny"  align="right" nowrap="nowrap">13:55</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >D105
</td><td class="printTiny"  align="right" nowrap="nowrap">-14:55</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">FY1A132180
</td></tr><tr class="schedulerow"  ><td class="printSchedule schedulecell"  colspan="2">Markus Himmelstrand
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1, P2, P3
</td></tr></table></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">14:00</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="2" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="22" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>FYSFYS01a</b></td><td class="printTiny"  align="right" nowrap="nowrap">14:15</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >D105
</td><td class="printTiny"  align="right" nowrap="nowrap">-16:05</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">FY1A132180
</td></tr><tr class="schedulerow"  ><td class="printSchedule schedulecell"  colspan="2">Markus Himmelstrand
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1, P2, P3
</td></tr></table></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">14:30</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="2" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="2" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">15:00</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>MATMAT03c</b></td><td class="printTiny"  align="right" nowrap="nowrap">15:05</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >K004
</td><td class="printTiny"  align="right" nowrap="nowrap">-16:05</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">MA3C+413212+6
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Johan Diser
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>MATMAT03c</b></td><td class="printTiny"  align="right" nowrap="nowrap">15:05</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >K005
</td><td class="printTiny"  align="right" nowrap="nowrap">-16:05</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">MA3C+413212+6
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Johan Diser
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1
</td></tr></table></td><td nowrap="nowrap" align="center" colspan="4" rowspan="12" valign="top" class=" schedulecell"  ><table width="100%" class="inline" cellspacing="0" cellpadding="0" ><tr class="schedulerow"><td class="printTiny schedulecell"  nowrap="nowrap"><b>BIOBIO01</b></td><td class="printTiny"  align="right" nowrap="nowrap">15:05</td></tr><tr class="schedulerow"   ><td class="printTiny schedulecell" >S2-015
</td><td class="printTiny"  align="right" nowrap="nowrap">-16:05</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">BI1122170
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">Helena Lexander
</td></tr><tr class="schedulerow"  ><td class="printTiny schedulecell"  colspan="2">P1, P2
</td></tr></table></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">15:30</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">16:00</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="11" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="11" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="11" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td><td nowrap="nowrap" align="center" colspan="4" rowspan="11" valign="top" class="printLight schedulecell"><img src="../../grafics/spacer.gif" alt=""  width="20px" height="3px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td width="5%" rowspan="6" class="printTiny schedulecell">16:30</td><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
<tr class="background schedulerow"><td class="scheduletimecell" width="1px"></td></tr>
</table></td>
  </center>



</body>
</html>`;

const Cheerio = require("cheerio");
const moment = require("moment");

const $ = Cheerio.load(html);

let objects = [];
const columns = 4 * 5;
const rows = 108;
let grid = Array(columns)
  .fill()
  .map(() =>
    Array(rows)
      .fill()
      .map(() => {
        return -2;
      })
  );
let events = [];

$("table.print > tbody > tr").each((index, elem) => {
  $(elem)
    .children("td:not([width='5%'],[width='1px'])")
    .each((i, elem) => {
      objects.push({
        row: index,
        colspan: elem.attribs["colspan"],
        rowspan: elem.attribs["rowspan"],
        ...($(elem).find("table").length > 0 && { elem: $(elem) }),
      });
    });
});

function getWidth(row) {
  for (let col = 0; col < columns; col++) {
    if (grid[col][row] == -2) return col;
  }
  return 12;
}

objects.forEach((object, i) => {
  const width = getWidth(object.row);
  if (!object.colspan || !object.rowspan) return;

  const id = object.elem ? events.push(object.elem) - 1 : -1;

  for (let col = 0; col < object.colspan; col++) {
    for (let row = 0; row < object.rowspan; row++) {
      grid[width + col][object.row + row] = id;
    }
  }
});

let i = 0;

function getDay(i) {
  return [
    ...new Set([...grid[i++], ...grid[i++], ...grid[i++], ...grid[i++]]),
  ].filter((val) => {
    return val >= 0;
  });
}

let mon = getDay(0);
let tue = getDay(4);
let wed = getDay(8);
let thu = getDay(12);
let fri = getDay(16);

function getEvents(eventIds, day, week) {
  let parsedEvents = [];
  eventIds.forEach((id) => {
    const $event = events[id];
    let firstType =
      $event.find("tr:nth-child(1) > td:not(.schedulecell)").text().length == 0;

    let data;
    if (firstType)
      data = {
        name: $event.find("tr:nth-child(1)").text().trim(),
        start: $event.find("tr:nth-child(2)").text().trim(),
        end: $event.find("tr:nth-child(3)").text().trim().slice(1),
        location: $event.find("tr:nth-child(4)").text().trim(),
        code: $event.find("tr:nth-child(5)").text().trim(),
        teacher: $event.find("tr:nth-child(6)").text().trim(),
        period: $event.find("tr:nth-child(7)").text().trim(),
      };
    else
      data = {
        name: $event.find("tr:nth-child(1) > td:nth-child(1)").text().trim(),
        start: $event.find("tr:nth-child(1) > td:nth-child(2)").text().trim(),
        end: $event
          .find("tr:nth-child(2) > td:nth-child(2)")
          .text()
          .trim()
          .slice(1),
        location: $event
          .find("tr:nth-child(2) > td:nth-child(1)")
          .text()
          .trim(),
        code: $event.find("tr:nth-child(3)").text().trim(),
        teacher: $event.find("tr:nth-child(4)").text().trim(),
        period: $event.find("tr:nth-child(5)").text().trim(),
      };

    let event = {
      startDate: moment()
        .startOf("year")
        .add(week, "weeks")
        .add(day - 3, "days")
        .add(moment.duration(data.start))
        .toISOString(),
      endDate: moment()
        .startOf("year")
        .add(week, "weeks")
        .add(day - 3, "days")
        .add(moment.duration(data.end))
        .toISOString(),
      location: data.location,
      type: "lesson",
      lessonEvent: {
        courseCode: data.code,
        courseName: data.name,
        courseId: -1,
        period: `${data.period.includes("P1") ? "1" : ""}${
          data.period.includes("P2") ? "2" : ""
        }${data.period.includes("P3") ? "3" : ""}`,
        teacherName: data.teacher,
      },
    };
    parsedEvents.push(event);
  });

  return parsedEvents;
}

const week = 33;

let allEvents = [
  ...getEvents(mon, 0, 33),
  ...getEvents(tue, 1, 33),
  ...getEvents(wed, 2, 33),
  ...getEvents(thu, 3, 33),
  ...getEvents(fri, 4, 33),
];
